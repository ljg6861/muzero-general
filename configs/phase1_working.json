{
    "description": "Phase 1 - Working Datasets Only",
    "phase": 1,
    "target_tokens": 150000000,
    "mix": {
        "description": "Token mixing with working datasets only",
        "wikipedia": 0.40,
        "wikitext": 0.30,
        "books": 0.30
    },
    "data_sources": [
        {
            "name": "wikipedia",
            "dataset": "wikimedia/wikipedia",
            "config_name": "20231101.en",
            "text_field": "text",
            "weight": 0.40,
            "description": "Full Wikipedia English"
        },
        {
            "name": "books",
            "dataset": "rojagtap/bookcorpus",
            "text_field": "text",
            "weight": 0.30,
            "description": "Books corpus"
        },
        {
            "name": "wikitext",
            "dataset": "wikitext",
            "config_name": "wikitext-103-raw-v1",
            "text_field": "text",
            "weight": 0.30,
            "description": "Wikitext corpus"
        }
    ],
    "training": {
        "ctx_len_schedule": {
            "initial": 1024,
            "ramp_to": 2048,
            "ramp_at_tokens": 50000000,
            "long_ctx_percentage": 0.05,
            "long_ctx_len": 4096,
            "long_ctx_start_tokens": 100000000
        },
        "sampling": {
            "temperature": 0.7,
            "description": "Up-weight rare/high-value shards"
        },
        "sequence_packing": true,
        "cross_doc_attention": false,
        "batch_size": 16,
        "accumulation_steps": 8,
        "learning_rate": 5e-4,
        "warmup_tokens": 20000000,
        "weight_decay": 0.01,
        "eval_every": 2000,
        "save_every": 5000,
        "log_every": 100
    },
    "model": {
        "vocab_size": 50257,
        "hidden_size": 768,
        "num_layers": 12,
        "num_heads": 12,
        "max_seq_len": 2048,
        "gradient_checkpointing": true,
        "enable_router": true,
        "enable_schema_inference": true,
        "enable_hybrid_memory": true,
        "enable_self_correction": true
    },
    "memory": {
        "async_fact_ingestion": true,
        "router_supervision": true,
        "memory_aux_loss_weight": 0.05,
        "router_loss_weight": 0.1
    }
}