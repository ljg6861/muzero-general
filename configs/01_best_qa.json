{
    "name": "best_qa",
    "description": "Question-answer optimized preset with heavier Q/A weighting and auxiliaries",
    "model": {
        "hidden_size": 256,
        "num_layers": 4,
        "num_heads": 4,
        "seq_length": 256
    },
    "train": {
        "train_tokens": 100000000,
        "eval_tokens": 2000000,
        "per_gpu_batch_size": 128,
        "accumulation_steps": 4,
        "lr": 5e-4,
        "weight_decay": 0.01,
        "fused_adamw": false,
        "grad_checkpointing": false,
        "num_workers": 2,
        "prefetch_factor": 2
    },
    "data": {
        "sources": [
            {
                "type": "hf",
                "dataset": "sentence-transformers/natural-questions",
                "split": "train",
                "fields": [
                    "question",
                    "answer"
                ],
                "format": "Q: {question}\nA: {answer}"
            },
            "wikipedia"
        ],
        "mix_strategy": "weighted",
        "source_weights": [
            3,
            1
        ],
        "min_text_length": 50
    },
    "auxiliary": {
        "enable_policy": true,
        "enable_value": true,
        "enable_dynamics": true,
        "enable_span_contrastive": true,
        "policy_kl_weight": 0.06,
        "value_weight": 0.06,
        "dynamics_weight": 0.05,
        "span_contrastive_weight": 0.05,
        "span_mask_fraction": 0.18,
        "span_contrastive_temperature": 0.06,
        "span_l2_normalize": true,
        "enable_adaptive_sources": true,
        "adaptive_interval_tokens": 4000000,
        "adaptive_min_weight": 0.5,
        "adaptive_max_weight": 3.5,
        "adaptive_smoothing": 0.9
    }
}